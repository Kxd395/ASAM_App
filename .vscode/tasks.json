{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Agent: Scaffold",
      "type": "shell",
      "command": "python3 agent/asm.py scaffold"
    },
    {
      "label": "Agent: Plan Hash",
      "type": "shell",
      "command": "python3 agent/asm.py plan.hash --in data/plan.sample.json"
    },
    {
      "label": "Agent: Validate",
      "type": "shell",
      "command": "python3 agent/asm.py plan.validate --in data/plan.sample.json"
    },
    {
      "label": "Agent: Build pdf_export",
      "type": "shell",
      "command": "bash scripts/build-swift-cli.sh"
    },
    {
      "label": "Agent: Export PDF",
      "type": "shell",
      "dependsOn": "Agent: Build pdf_export",
      "command": "python3 agent/asm.py pdf.export --plan data/plan.sample.json --pdf assets/ASAM_TreatmentPlan_Template.pdf --sig assets/sample_signature.png --out out/ASAMPlan_$(python3 agent/asm.py rand.id).pdf"
    },
    {
      "label": "Agent: Postrun",
      "type": "shell",
      "options": {
        "cwd": "${workspaceFolder}/agent_ops"
      },
      "command": "python3 tools/agent_postrun.py --run-id $(date +%Y%m%d%H%M%S) --actor agent --summary \"${input:summary}\" --completed ${input:completed} --artifacts ${input:artifacts}",
      "problemMatcher": []
    },
    {
      "label": "Agent: Check Root Hygiene",
      "type": "shell",
      "options": {
        "cwd": "${workspaceFolder}/agent_ops"
      },
      "command": "python3 tools/check_root_files.py",
      "problemMatcher": []
    }
  ],
  "inputs": [
    {
      "id": "summary",
      "type": "promptString",
      "description": "Run summary (no PHI)",
      "default": "Updated docs and tasks"
    },
    {
      "id": "completed",
      "type": "promptString",
      "description": "Completed task IDs (space separated, e.g., T-0001 T-0003)",
      "default": ""
    },
    {
      "id": "artifacts",
      "type": "promptString",
      "description": "Artifact paths (space separated, e.g., artifacts/export.pdf)",
      "default": ""
    }
  ]
}
