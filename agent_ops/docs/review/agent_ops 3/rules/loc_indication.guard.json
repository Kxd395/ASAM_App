{
  "version": "1.1.0",
  "algorithm": "max_precedence",
  "notes": "Guarded so base 3.7 does not fire when WM candidates already demand 3.7/4.0.",
  "enabled_levels": [
    "2.1",
    "3.1",
    "3.5",
    "3.7",
    "4.0"
  ],
  "rules": [
    {
      "rule_id": "loc_iop_default",
      "if": {
        "A": "<=2",
        "B": "<=2",
        "C": "<=2",
        "E": "<=2"
      },
      "then": {
        "indicated_loc": "2.1",
        "why": [
          "stable_structured_support"
        ]
      },
      "precedence": 10
    },
    {
      "rule_id": "loc_residential_low",
      "if": {
        "A": "<=1",
        "B": "<=2",
        "C": "<=2",
        "E": ">=3"
      },
      "then": {
        "indicated_loc": "3.1",
        "why": [
          "environment_structure"
        ]
      },
      "precedence": 20
    },
    {
      "rule_id": "loc_residential_high",
      "if": {
        "A": "<=2",
        "B": "<=3",
        "C": ">=3",
        "E": ">=3"
      },
      "then": {
        "indicated_loc": "3.5",
        "why": [
          "psychiatric_environment"
        ]
      },
      "precedence": 40
    },
    {
      "rule_id": "loc_wm_escalation",
      "if": {
        "wm_candidate": [
          "3.7",
          "4.0"
        ]
      },
      "then": {
        "indicated_loc": "3.7",
        "why": [
          "wm_requires_medical_setting"
        ]
      },
      "precedence": 70
    },
    {
      "rule_id": "loc_med_managed_res",
      "if": {
        "B": ">=3",
        "wm_candidate": [
          "!3.7",
          "!4.0"
        ]
      },
      "then": {
        "indicated_loc": "3.7",
        "why": [
          "biomedical_management"
        ]
      },
      "precedence": 60
    },
    {
      "rule_id": "loc_inpatient",
      "if": {
        "A": ">=4",
        "B": ">=4"
      },
      "then": {
        "indicated_loc": "4.0",
        "why": [
          "severe_withdrawal_and_biomedical"
        ]
      },
      "precedence": 80
    }
  ],
  "fallback": {
    "indicated_loc": "2.1",
    "why": [
      "fallback_default"
    ]
  }
}